Functional Requirements (FR)
- FR1. GUI: две кнопки (Analyze, Stop), логотип/анимация, окно лога
- FR2. Analyze: пройти по клипам активного таймлайна, выполнить sampling → извлечь фичи → кластеризовать → присвоить цветовые метки
- FR3. Ignore Artifacts: устойчивость к вспышкам/фарам, чёрным рамкам, fish-eye искажениям, профилям Log/Rec709/VHS
- FR4. Undo: откат последнего запуска по run-id
- FR5. Report: краткий отчёт (кол-во групп, распределение клипов, длительность анализа)
- FR6. Beta-Hook: точка расширения для внешней ML-валидации

Non-Functional Requirements (NFR)
- NFR1. Offline работа
- NFR2. Latency: ≤30 сек на ~20 мин таймлайн
- NFR3. UX: «одна кнопка» без обязательных настроек; Stop всегда доступна
- NFR4. Stability: при ошибке — лог + откат без изменений
- NFR5. Compat: Resolve 20, macOS 15.6; расширение на Win/Linux позже
- NFR6. Packaging: зависимости оформлены для прозрачной установки

Constraints
- Resolve Python API ограничен, нет внешних пакетов «из коробки»
- В Free версии нет UI Manager → fallback PyQt
- Лицензирование PyQt/моделей обязательно проверить

Acceptance Criteria (MVP)
1) GUI открывается (встроенный или внешнее PyQt)
2) Нажатие Analyze раскрашивает клипы минимум в 2–3 группы
3) Stop прерывает анализ без артефактов
4) Undo снимает изменения последнего прогона
5) Лог показывает общее время, число клипов, число групп, признаки отброшенных вспышек/рамок

Test Cases (минимум)
- TC-01: Смешанный Log/Rec709 без рамок → ≥2 группы
- TC-02: Материал со вспышками/фарами → вспышки не создают отдельные группы
- TC-03: Материал 4:3 в 16:9 → рамки игнорируются
- TC-04: Длинные клипы → sampling работает, без тайм-аута
- TC-05: Stop в середине анализа → незавершённые клипы не помечены
- TC-06: Undo возвращает таймлайн в исходное состояние

Milestones
- M1 (Skeleton): GUI + проход по клипам + лог (кластеризатор-заглушка)
- M2 (Sampler+Features): устойчивый sampling и feature extractor
- M3 (Clusterer): HDBSCAN/k-means + mapping цветов + отчёт
- M4 (Undo/Polish): run-id, Undo, стабильность
- M5 (Beta-Hook): внешний ML-валидатор (опционально)